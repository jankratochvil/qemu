##
# = Virtio devices
##

##
# @VirtioInfo:
#
# Information about a given VirtIODevice
#
# @type: VirtIO device type.
#
# @path: VirtIO device canonical path.
#
# Since: 5.0
##
{ 'struct': 'VirtioInfo',
  'data': {
    'path': 'str',
    'type': 'str'
  }
}

##
# @query-virtio:
#
# Return the list of all VirtIO devices
#
# Returns: list of @VirtioInfo
#
# Since: 5.0
##

{ 'command': 'query-virtio', 'returns': ['VirtioInfo'] }

##
# @VirtQueueStatus:
#
##

{ 'struct': 'VirtQueueStatus',
  'data': {
    'queue_index': 'uint16',
    'inuse': 'uint32',
    'vring_num': 'int',
    'vring_num_default': 'int',
    'vring_align': 'int',
    'vring_desc': 'uint64',
    'vring_avail': 'uint64',
    'vring_used': 'uint64',
    'last_avail_idx': 'uint16',
    'shadow_avail_idx': 'uint16',
    'used_idx': 'uint16',
    'signalled_used': 'uint16',
    'signalled_used_valid': 'uint16'
  }
}

##
# @virtio-queue-status:
##

{ 'command': 'virtio-queue-status',
  'data': { 'path': 'str', 'queue': 'uint16' },
  'returns': 'VirtQueueStatus'
}

##
# @VirtioStatus:
#
##

{ 'struct': 'VirtioStatus',
  'data': {
    'device_id': 'int',
    'device_endian': 'str',
    'guest_features': 'uint64',
    'host_features': 'uint64',
    'backend_features': 'uint64',
    'num_vqs': 'uint16'
  }
}

##
# @virtio-status:
#
##

{ 'command': 'virtio-status',
  'data': { 'path': 'str' },
  'returns': 'VirtioStatus'
}

##
# @VirtioRingDesc:
#
##

{ 'struct': 'VirtioRingDesc',
  'data': {
    'addr': 'uint64',
    'len': 'uint32',
    'flags': 'uint16'
  }
}

##
# @VirtioQueueElement:
#
##

{ 'struct': 'VirtioQueueElement',
  'data': {
    'index': 'uint32',
    'len': 'uint32',
    'ndescs': 'uint32',
    'descs': ['VirtioRingDesc']
  }
}

##
# @virtio-queue-element:
#
##

{ 'command': 'virtio-queue-element',
  'data': { 'path': 'str', 'queue': 'uint16', '*index': 'uint16' },
  'returns': 'VirtioQueueElement'
}
